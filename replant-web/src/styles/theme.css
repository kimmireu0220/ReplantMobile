/**
 * Replant Dark Mode Theme System
 * Material Design 기반 다크 테마: #121212 배경, 텍스트 opacity 87/60/38, 2단계 섀도우.
 * 이 파일은 런타임 소스 오브 트루스이며, 상세 설계는 docs/architecture/THEME_SYSTEM.md 참고.
 */

/* ===== 기본 라이트 테마 (기존 색상과 동일) ===== */
:root {
  /* 기본 배경 색상 - 기존 globals-minimal.css와 동일 */
  --color-background-body: #f5f5f5;
  --color-background-primary: #ffffff;
  --color-background-secondary: #f9fafb;
  --color-background-tertiary: #f3f4f6;
  
  /* 기본 텍스트 색상 - 기존 globals-minimal.css와 동일 */
  --color-text-primary: #333333;
  --color-text-secondary: #6b7280;
  --color-text-tertiary: #9ca3af;
  --color-text-inverse: #ffffff;
  
  /* Primary 색상 - 실제 사용되는 것만 유지 */
  --color-primary-100: #dcfce7;
  --color-primary-200: #bbf7d0;
  --color-primary-300: #86efac;
  --color-primary-400: #4ade80;
  --color-primary-500: #22c55e;
  --color-primary-600: #16a34a;
  
  /* Gray 색상 - tokens.js와 동일 */
  --color-gray-100: #f3f4f6;
  --color-gray-200: #e5e7eb;
  --color-gray-300: #d1d5db;
  --color-gray-400: #9ca3af;
  --color-gray-500: #6b7280;
  --color-gray-600: #4b5563;
  --color-gray-900: #111827;
  
  /* Border 색상 */
  --color-border-light: #e5e7eb;
  --color-border-medium: #d1d5db;
  --color-border-dark: #9ca3af;
  
  /* Shadow 색상 - 간소화된 2단계 시스템 */
  --color-shadow-light: rgba(0, 0, 0, 0.05);
  --color-shadow-medium: rgba(0, 0, 0, 0.15);
  
  /* Semantic 색상 - tokens.js와 동일 */
  --color-success: #22c55e;
  --color-warning: #f59e0b;
  --color-error: #ef4444;
  --color-info: #3b82f6;
  
  /* 난이도별 추가 색상 (difficultyStyles.js 지원) */
  --color-warning-light: #fef3c7;
  --color-warning-dark: #92400e;
  --color-error-light: #fee2e2;
  --color-error-dark: #991b1b;
  
  /* 감정 색상 - tokens.js와 동일 */
  --color-emotion-happy: #b45309;
  --color-emotion-excited: #c2410c;
  --color-emotion-calm: #0e7490;
  --color-emotion-grateful: #7c3aed;
  --color-emotion-sad: #6b7280;
  --color-emotion-angry: #dc2626;
  --color-emotion-anxious: #b45309;
  --color-emotion-tired: #64748b;
  
  /* 카테고리 액센트 색상 - 실제 사용되는 것만 */
  --color-accent-blue: #2563eb;
  --color-accent-green: #15803d;
  --color-accent-orange: #c2410c;
  --color-accent-purple: #7c3aed;
  --color-accent-yellow: #b45309;

  /* "전체" 카테고리 전용 색상 (라이트 모드) */
  --color-category-all-bg: #f3f4f6; /* gray-100 */
  --color-category-all-border: #d1d5db; /* gray-300 */
  --color-category-all-text: #374151; /* gray-700 */
  --color-category-all-bg-selected: rgba(55, 65, 81, 0.1); /* gray-700 with 10% opacity */
  --color-category-all-border-selected: #374151; /* gray-700 */
  --color-category-all-text-selected: #374151; /* gray-700 */

  /* Progress defaults (light) */
  --progress-track: #e5e7eb; /* gray-200 */
  --progress-fill: var(--color-primary-500);
}

/* ===== 다크 테마 오버라이드 (Material Design 기반) ===== */
[data-theme="dark"] {
  /* 배경 색상 - Material Design 권장 (#121212 기반) */
  --color-background-body: #121212;        /* Material Design 다크 배경 */
  --color-background-primary: #1e1e1e;     /* Elevation 1dp */
  --color-background-secondary: #232323;   /* Elevation 2dp */
  --color-background-tertiary: #2a2a2a;    /* Elevation 4dp */
  
  /* 텍스트 색상 - Material Design 권장 opacity 적용 */
  --color-text-primary: rgba(255, 255, 255, 0.87);      /* High emphasis - 87% opacity */
  --color-text-secondary: rgba(255, 255, 255, 0.60);    /* Medium emphasis - 60% opacity */
  --color-text-tertiary: rgba(255, 255, 255, 0.38);     /* Disabled - 38% opacity */
  --color-text-inverse: #ffffff;
  
  /* Primary 색상 - 실제 사용되는 것만 (다크모드 최적화) */
  --color-primary-100: #1f3a1f;    /* Surface tint */
  --color-primary-200: #2d4a2d;    /* Elevated surface */
  --color-primary-300: #4ade80;    /* Desaturated */
  --color-primary-400: #34d399;    /* Main interactive */
  --color-primary-500: #10b981;    /* Primary */
  --color-primary-600: #059669;    /* Hover state */
  
  /* Gray 색상 - Material Design elevation 기반 */
  --color-gray-100: #2a2a2a;       /* Elevation 4dp */
  --color-gray-200: #303030;       /* Elevation 6dp */
  --color-gray-300: #373737;       /* Elevation 8dp */
  --color-gray-400: #3f3f3f;       /* Elevation 12dp */
  --color-gray-500: rgba(255, 255, 255, 0.60);  /* Medium emphasis text */
  --color-gray-600: rgba(255, 255, 255, 0.87);  /* High emphasis text */
  --color-gray-900: rgba(255, 255, 255, 0.87);  /* High emphasis text */
  
  /* Border 색상 - Material Design elevation 기반 */
  --color-border-light: #2a2a2a;     /* Elevation 4dp */
  --color-border-medium: #373737;    /* Elevation 8dp */
  --color-border-dark: #3f3f3f;      /* Elevation 12dp */
  
  /* Shadow 색상 - 간소화된 2단계 시스템 */
  --color-shadow-light: rgba(0, 0, 0, 0.2);     /* 일반 카드 */
  --color-shadow-medium: rgba(0, 0, 0, 0.4);    /* Elevated 요소 */
  
  /* Semantic 색상 - Material Design 권장 desaturated colors */
  --color-success: #4ade80;        /* 약간 desaturated */
  --color-warning: #fbbf24;        /* 유지 - 이미 적절함 */
  --color-error: #f87171;          /* 약간 desaturated */
  --color-info: #60a5fa;           /* 약간 desaturated */
  
  /* 난이도별 다크 테마 색상 */
  --color-warning-light: #451a03;  /* 다크 배경용 */
  --color-warning-dark: #fbbf24;   /* 밝은 텍스트 */
  --color-error-light: #450a0a;    /* 다크 배경용 */
  --color-error-dark: #f87171;     /* 밝은 텍스트 */
  
  /* 감정 색상 - Material Design 기반 desaturated colors */
  --color-emotion-happy: #fde047;      /* 약간 desaturated 노란색 */
  --color-emotion-excited: #fb923c;    /* 약간 desaturated 주황색 */
  --color-emotion-calm: #67e8f9;       /* 약간 desaturated 청록색 */
  --color-emotion-grateful: #c4b5fd;   /* 약간 desaturated 보라색 */
  --color-emotion-sad: rgba(255, 255, 255, 0.60);    /* Medium emphasis */
  --color-emotion-angry: #fca5a5;      /* 약간 desaturated 빨간색 */
  --color-emotion-anxious: #fde047;    /* 약간 desaturated 노란색 */
  --color-emotion-tired: rgba(255, 255, 255, 0.60);  /* Medium emphasis */
  
  /* 카테고리 액센트 색상 - 실제 사용되는 것만 (desaturated) */
  --color-accent-blue: #93c5fd;       /* 약간 desaturated */
  --color-accent-green: #86efac;      /* 약간 desaturated */
  --color-accent-orange: #fdba74;     /* 약간 desaturated */
  --color-accent-purple: #c4b5fd;     /* 약간 desaturated */
  --color-accent-yellow: #fde047;     /* 약간 desaturated */

  /* "전체" 카테고리 전용 색상 (Material Design elevation 기반) */
  --color-category-all-bg: #2a2a2a;             /* Elevation 4dp */
  --color-category-all-border: #373737;         /* Elevation 8dp */
  --color-category-all-text: rgba(255, 255, 255, 0.60);  /* Medium emphasis */
  --color-category-all-bg-selected: #373737;    /* Elevation 8dp */
  --color-category-all-border-selected: #3f3f3f; /* Elevation 12dp */
  --color-category-all-text-selected: rgba(255, 255, 255, 0.87); /* High emphasis */

  /* Progress - Material Design elevation 기반 */
  --progress-track: #2a2a2a;      /* Elevation 4dp */
  --progress-fill: var(--color-primary-400);  /* Desaturated primary */
}

/* ===== 시스템 테마 대응 (선택사항) ===== */
@media (prefers-color-scheme: dark) {
  /* 시스템이 다크 모드이고 data-theme이 설정되지 않은 경우에만 적용 */
  :root:not([data-theme]) {
    /* Material Design 기반 다크 테마 변수들 적용 */
    --color-background-body: #121212;        /* Material Design 다크 배경 */
    --color-background-primary: #1e1e1e;     /* Elevation 1dp */
    --color-background-secondary: #232323;   /* Elevation 2dp */
    --color-background-tertiary: #2a2a2a;    /* Elevation 4dp */
    
    --color-text-primary: rgba(255, 255, 255, 0.87);      /* High emphasis */
    --color-text-secondary: rgba(255, 255, 255, 0.60);    /* Medium emphasis */
    --color-text-tertiary: rgba(255, 255, 255, 0.38);     /* Disabled */
    --color-text-inverse: #ffffff;
  }
}

/* ===== 필수 Typography 변수만 유지 ===== */
[data-theme="dark"] {
  /* 핵심 Typography */
  --font-weight-normal: 400;
  --font-weight-medium: 500;
  --font-weight-semibold: 600;
  --font-weight-bold: 700;
}

/* ===== 테마 전환 애니메이션 ===== */
* {
  /* 테마 변경 시 부드러운 전환 효과 */
  transition: 
    background-color 0.2s ease-in-out,
    color 0.2s ease-in-out,
    border-color 0.2s ease-in-out,
    box-shadow 0.2s ease-in-out;
}

/* 성능 최적화를 위해 특정 요소는 애니메이션 제외 */
canvas,
video,
iframe,
img {
  transition: none !important;
}

/* ===== 핵심 유틸리티 클래스만 유지 ===== */
.theme-text-primary {
  color: var(--color-text-primary);
}

.theme-text-secondary {
  color: var(--color-text-secondary);
}

.theme-bg-primary {
  background-color: var(--color-background-primary);
}

.theme-bg-secondary {
  background-color: var(--color-background-secondary);
}

.theme-border {
  border-color: var(--color-border-light);
}

/* ===== 접근성 최적화 ===== */
@media (prefers-reduced-motion: reduce) {
  * {
    transition: none !important;
  }
}

/* ===== 간소화된 다크모드 배경 ===== */
[data-theme="dark"] body {
  background: linear-gradient(180deg, #121212 0%, #0f0f0f 100%);
  background-attachment: fixed;
}

[data-theme="dark"] .card-enhanced {
  background: linear-gradient(145deg, #1e1e1e 0%, #1a1a1a 100%);
  box-shadow: 0 4px 16px var(--color-shadow-light);
  border: 1px solid rgba(255, 255, 255, 0.08);
}

[data-theme="dark"] .card-enhanced:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 24px var(--color-shadow-medium);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

/* ===== 상담 채팅 입력 접근성 보강 ===== */
#chat-input {
  color: var(--color-text-primary);
  background-color: var(--color-background-primary);
}

#chat-input::placeholder {
  color: var(--color-text-secondary);
  opacity: 1;
}

[data-theme="dark"] #chat-input::placeholder {
  color: var(--color-text-secondary);
  opacity: 1;
}

/* 고대비 모드 지원 */
@media (prefers-contrast: high) {
  :root {
    --color-text-primary: #000000;
    --color-text-secondary: #333333;
    --color-border-light: #000000;
  }
  
  [data-theme="dark"] {
    --color-text-primary: #ffffff;
    --color-text-secondary: #e0e0e0;
    --color-border-light: #ffffff;
  }
}